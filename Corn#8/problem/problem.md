# Corn#8

|题目名称|英文简称|时间限制|空间限制|测试点数|下发文件|
|:--------:|:-------:|:-----:|:------:|:--:|:--:|
| 校园游览 | `visit` | 1 sec | 256 MB | 10 | 无 |
| 文件查找 | `regex` | 1 sec | 512 MB | 20 | 无 |
| 成绩统计 | `score` | 1 sec | 256 MB | 20 | 无 |

- 出题人：单敬博

- 验题人：樊睿

- 出题人对题目难度的**估计**：**NOIP2018-Day2**

- 本场比赛使用**文件输入输出，请看清并正确拼写文件名**

- 强烈建议使用 `C++(NOI)` 提交程序，以防现场考试时 `Compile Error` 之惨状

- 不建议使用 `<bits/stdc++.h>`

- 建议使用 `NOI Linux` 答题

- 出题人的建议：

  - **仔细读题，冷静分析，独立思考，合理取舍**

## T1 校园游览 

`visit` | 1 sec | 256 MB | 10 Case

### 题目描述

小F计划在周末游览玉米高中美丽的校园。玉米高中的校园中有 $n$ 处景观（编号 $1\dots n$），$n-1$ 条互不交叉的小路，小路 $i$ 将编号为 $x_i$ 和 $y_i$ 的两个景观连接起来，长度为 $z_i$ 单位距离，这些小路使全部景观两两连通。  

$1$ 号景观是学校大门，小F的游览将从此开始。为了防止迷路，小F还选择了 $t(t \neq 1)$ 号景观作为此行的目标。

由于小F的体力有限，只能够行走 $d$ 单位距离，所以他在沿从 $1$ 号景观到 $t$ 号景观的路线行走到仍有足够体力返回大门的最远景观时就掉头返回。若小F的体力有富余，他也不会在到达 $t$ 号景观后继续前往其他景观，而是直接原路返回。

在游览前，小F制定了 $m$ 份游览计划，在第 $j$ 份计划中，游览目标为 $t_j$，他对能够行走的最远距离 $d$ 的估计值为 $d_j$，小F想要知道，如果符合预期，他能够到达的最远景观的编号 $p_j$。

![然而小F只会LCT、后缀自动机和毒瘤卡常分块其他什么也不会，请你帮帮他。](https://s1.ax1x.com/2020/08/10/aqZbFK.png)

### 输入格式

从文件 `visit.in` 中读入。

第一行包含两个正整数 $n$ 和 $m$。

接下来 $n$ 行，每行三个正整数 $x_i,y_i,z_i$ 表示一条小路。

接下来 $m$ 行，每行两个非负整数 $t_j,d_j$ 表示一次询问。

### 输出格式

向文件 `visit.out` 输出。

对每次询问输出一行一个整数表示答案。

### 样例

#### 样例输入 1
```plain
5 5
1 2 2
2 3 3
2 4 1
1 5 4
2 2
3 9
2 7
4 9
5 7
```

#### 样例输出 1
```plain
1
2
2
4
1
```

### 数据范围

|测试点编号|$n=$|$m=$|特殊性质|
|:--:|:------------:|:--------------:|:-:|
|$1$ |$10^2$        |$10^3$          | 0 |
|$2$ |$10^2$        |$10^3+1$        | 1 |
|$3$ |$5\times 10^3$|$5\times 10^3$  | 0 |
|$4$ |$5\times 10^3$|$5\times 10^3+1$| 1 |
|$5$ |$5\times 10^3$|$5\times 10^3+2$| 2 |
|$6$ |$5\times 10^3$|$5\times 10^3+3$| 3 |
|$7$ |$10^5$        |$10^5$          | 0 |
|$8$ |$10^5$        |$10^5+1$        | 1 |
|$9$ |$10^5$        |$10^5+2$        | 2 |
|$10$|$10^5$        |$10^5+3$        | 3 |

特殊性质：
- 0：图随机生成
- 1：图是 $1$ 为一个端点的链
- 2：图是 $1$ 为根的满二叉树
- 3：无特殊性质

对于 $100\%$ 的数据：
- $n\leq 10^5$
- $m\leq 10^5+3$
- $1 \leq z_i \leq 10^4$
- $0 \leq d_j \leq 10^9$

## T2 文件查找

`regex` | 1 sec | 512 MB | 20 Case

### 题目描述

作为玉米高中的基房管理员，小S需要管理大量的文件。

小S的前任管理员把所有文件都放在了一个文件夹中，没有任何组织结构可言。

现在一位老师想向你查询一个文件，但他的记性不太好，忘记了文件名中连续的一段，他只好用一个 $*$ 代表他忘记了的部分，$*$ 代表的部分可长可短，甚至不代表任何字符——他只是记错了。

作为一位尽职尽责的基房管理员，小S决定查找出所有符合要求的文件，并把可能的文件的**数量**告诉他。

小S一共拿到了 $n$ 份文件（显然地，文件名不能相同），而老师共向他查询了 $m$ 次。

然而小S不会正则表达式，请你帮帮他。

> 有 $n$ 个字符串 $S_i$，全部由小写字母组成  
> 另有 $m$ 个字符串 $T_j$，除小写字母外，每个字符串中有且仅有一个 $*$ 字符  
> 其中 $*$ 字符能够匹配任意字符串（含空串）  
> 对每个字符串 $T_j$，求有多少个字符串 $S_i$ 能被匹配。

### 输入格式

从文件 `regex.in` 中读入。

第一行包含两个正整数 $n$ 和 $m$。

接下来 $n$ 行，每行一个字符串表示一个文件名。

接下来 $m$ 行，每行一个字符串表示一次询问。

### 输出格式

向文件 `regex.out` 输出。

对每次询问输出一行一个整数表示答案。

### 样例

#### 样例输入 1
```plain
6 5
a
ab
ac
abc
abdc
bc
a*c
*c
ab*
a*dc
*d
```

#### 样例输出 1
```plain
3
4
3
1
0
```

#### 样例输入 2
```plain
14 7
frnoiag
frapiocu
frwccu
frnoicu
frctsccu
ysjnoiag
ysjwccu
ysjnoipak
ysjnoicu
ysjapiocu
sjbnoiag
sjbapiocu
sjbwccu
sjbnoipak
fr*
*noiag
sjb*
fr*cu
*noipak
ysj*
frnoi*
```

#### 样例输出 2
```plain
5
3
4
4
2
5
2
```

### 数据范围

|测试点编号|$\sum length(S_i)<$|$\sum length(T_j)<$|特殊性质|
|:--------:|:----:|:----:|:---------------:|
|$1 ,    2$|$10^2$|$10^2$|$*$ 只出现在首或尾|
|$3 ,    4$|$10^3$|$10^3$|$*$ 只出现在首或尾|
|$5 \sim 8$|$10^4$|$10^4$|$*$ 只出现在首或尾|
|$9 \sim12$|$10^5$|$10^5$|$*$ 只出现在首或尾|
|$13\sim18$|$10^6$|$10^6$|$*$ 只出现在首或尾|
|$19,   20$|$10^6$|$10^6$|                 |

对于 $100\%$ 的数据：$\sum length(S_i)< 10^6$，$\sum length(T_j) < 10^6$

## T3 成绩统计

`score` | 1 sec | 256 MB | 20 Case

### 题目描述

玉米高中的期末考试结束了，老师们开始批阅试卷。他们~~抓~~找到了小Y，帮助他们统计成绩。

他们会给小Y如下几种指令或询问：
1. `Ins` $x$：老师们批完了一张试卷，得分为 $x$；
2. `Del` $x$：一张得分为 $x$ 的试卷被发现作弊而销毁；
3. `Rnk` $x$：向你询问已经批完、未被销毁的试卷中，得分为 $x$ 的试卷的排名（得分相同的试卷排名相同且最小）；
4. `Kth` $k$：向你询问已经批完、未被销毁的试卷中，从高到低排序，第 $k$ 张试卷的得分；
5. `rEv`：老师们突发奇想，把已经批完、未被销毁的所有试卷的分数按 $10$ 进制翻转（如：$233 \rightarrow 332, 150 \rightarrow 51$）

老师们保证：指令或询问数 $n \leq 3\times 10^5$，得分 $x \in \left[0,10^9\right)$。

此外，老师们可能还有一些奇怪的习惯，这些习惯将在 $\text{type}$ 中给出，具体含义见**数据范围**。

老师们郑重承诺：所有指令或询问合法。

然而小Y不会数据结构，请你帮帮他。

> 维护一个有序数列，支持：
> - 插入 $x$
> - 删除 $x$
> - 查询 $x$ 的排名
> - 查询 第 $k$ 名
> - 将所有数十进制翻转
> 
> 保证操作合法

### 输入格式

从文件 `score.in` 中读入。

第一行包含正整数 $n$ 和字符串 $\text{type}$。

接下来 $n$ 行，每行表示一条指令或询问。

为了减小输入文件大小，指令或询问字符串用其中唯一的**大写字母**简记。

### 输出格式

向文件 `score.out` 输出。

对每条询问输出一行一个整数表示答案。

### 样例

#### 样例输入 1
```plain
10 C2
I 150
I 149
E
I 100
K 3
R 100
E
D 15
R 149
K 2
```

#### 样例输出 1
```plain
51
2
1
1
```

#### 样例说明 1
第一次翻转后，得分依次为：$941$，$51$；  
第二次翻转后，得分依次为：$149$，$15$，$1$。

#### 样例输入 2
```plain
6 C2   
I 20
I 8
D 20
E
E
K 1 
```

#### 样例输出 2
```plain
8
```

### 数据范围

|测试点编号|$\text{type}$|$n=$|
|:-----:|:--:|:-----:|
|    $1$| A2 |$10^2$|
|  $2,3$| B2 |$10^2$|
|  $4,5$| B1 |$10^4$|
|    $6$| A2 |$10^4$|
|  $7,8$| B2 |$10^4$|
| $9,10$| C0 |$3\times 10^5$|
|$11,12$| A1 |$3\times 10^5$|
|$13,14$| A2 |$3\times 10^5$|
|$15,16$| B2 |$3\times 10^5$|
|$17\sim 20$| C2 |$3\times 10^5$|

对于 $100\%$ 的数据：
- $n\leq 3\times 10^5$
- $0\leq x< 10^9$

对 `rEv` 和 $x$ 的额外约束：
- A：没有 `rEv`
- B：$x < n$
- C：无额外约束

对其他指令或询问的额外约束：
- 0：没有 `Del` ，所有 `Ins` 都在最开始进行
- 1：所有 `Rnk` 和 `Kth` 都在 `Ins` 和 `Del` 之后
- 2：无额外约束
