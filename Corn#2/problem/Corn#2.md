# Corn#2

| 题目名称 | 奆炮的重生   | 幽香的宴会   | 玉米的丰收   |
|:----:|:-------:|:-------:|:-------:|
| 英文名称 | `pao`   | `party` | `WA`    |
| 时间限制 | `1s`    | `2s`    | `1s`    |
| 空间限制 | `256MB` | `512MB` | `256MB` |
| 测试点数 | `10`    | `25`    | `20`    |
| 附加样例 | 无       | 有       | 有       |
| 出题人  | `FR`    | `YSJ`   | `SJB`   |

---

# T1 奆炮的重生

英文名称：`pao.*`

时间限制：`1s`  

空间限制：`256MB`

测试点数：`10`

### 题目描述

传说，在$2147483647$年前，有一个可以发出震碎天地的$\text {AK IOI}$的轰鸣的奆炮。奆炮过处无题不切。但由于他过于强大，被一群大佬联合围攻致死，尸体被砍成了$n$个炮。这$n$个炮无时无刻没在想着重回巅峰时期。

$2147483647$年过去了，这$n$个炮终于等到了时机。他们围成一圈，决定重新合成奆炮。

每个炮都有一个$\text {fAKe}$值，**有正有负**。

每次他们可以进行如下操作：

- **双炮合一**：选择**相邻的**两个炮，把他们融合成一个大炮，融合的时候，这两个炮会暴躁，因为他们的自我意识将会永远消失在这个世界上。假设你选择的两个炮的$\text {fAKe}$值分别为$A,B$，则产生的大炮吸收了他们的怒火，$\text {fAKe}$值是$A+B$。
- **三炮合一**：选择**相邻的**三个炮，把他们融合成一个巨炮，融合的时候，两侧的炮会非常暴躁，因为他们的自我意识将会永远消失在这个世界上；但中间的炮会满足，因为很快两侧的炮就会变成自己的一部分。假设你选择的三个炮的$\text {fAKe}$值分别为$A,B,C$，则产生的巨炮吸收了他们的怒火，$\text {fAKe}$值为$A \times C-B$。

显然这一圈炮合最终将合并成一个炮。当这个炮达到可能得到的最大的$\text {fAKe}$值之时，他就会蜕变成奆炮。请你求出这个值。保证这个数小于$2^{63}$。

### 输入格式

从文件 `pao.in` 中读入数据。

第一行一个整数$T$，以下$T$组数据：

每组数据第一行一个整数$n$。

第二行$n$个整数，顺时针给出每个炮的$\text {fAKe}$值。

### 输出格式

向文件 `pao.out` 中输出答案。

每组数据一行一个整数，最终获得的奆炮的$\text {fAKe}$值。

### 样例1

> **输入**
> 
> ```plain
> 5
> 3
> 3 4 5
> 5
> 3 2 7 6 8
> 7
> 1 0 4 8 5 7 6
> 8
> 1 9 2 6 0 8 1 7
> 9
> 9 9 8 2 4 4 3 5 3
> ```
> 
> **输出**
> 
> ```plain
> 17
> 148
> 583
> 4022
> 6000
> ```
> 
> **解释**
> 
> - 第一组：$4\times 5-3=17$
> - 第二组：$3\times 7-2=19,19\times 8-6=148$
> - 第三组：$6+1=7,4+8=12,7\times 12-0=84,84\times 7-5=583$
> - 第四组：~~共建和谐社会。~~
> - 第五组：略

### 数据范围

所有测试点满足：

- $T \leq 50$
- $n \leq 35$
- 初始时 $|\text {fAKe}$值$| \leq 10$

| Case | $n$       |
|:----:|:---------:|
| $1$  | $\leq 3$  |
| $2$  | $\leq 4$  |
| $3$  | $\leq 5$  |
| $4$  | $\leq 7$  |
| $5$  | $\leq 10$ |
| $6$  | $\leq 15$ |
| $7$  | $\leq 20$ |
| $8$  | $\leq 25$ |
| $9$  | $\leq 30$ |
| $10$ | $\leq 35$ |

---

# T2 幽香的宴会

英文名称：`party.*`

时间限制：`2s`

空间限制：`512MB`

测试点数：`25`

### 题目描述

幽香是全幻想乡里最受人欢迎的萌妹子，这天，是幽香的2604岁生日，无数幽香的好朋友到了幽香家门前的太阳花田上来为幽香庆祝生日。

过生日当然要举办一场盛大的宴会，而幽香决定拿出太阳花田中最美味的 $k$ 个玉米来招待客人。

作为前来参加生日宴会的一员，你观察到了一件有趣的事：太阳花田中有 $n$ 块玉米田，而这些玉米田之间有 $m$ 条道路。

身为一位智慧的大妖怪，幽香自然保证了每条道路不会连接同一块玉米田，而且不会有道路连接的两块玉米田完全相同。但是，由于熊孩子的破坏，这些玉米田可能不像幽香开始规划的那样互相连通，也就是说从一块玉米田出发不一定能到达另一块玉米田。

同时，对玉米颇有了解的你发现每块玉米田中玉米的美味度和很多因素有关，比如说光照，潮湿度，土壤的肥度等等，而每块玉米田 $i$ 中的玉米美味度可以粗略的当成某个计算出的值 $w_i$ （当然，粗略值对幽香来说已经够用了）。

为了美观，幽香不想破坏每块玉米田的结构，所以在每块玉米田中她最多只会采一个玉米。

不幸的是，宴会刚开始的时候天上突然下起了大雨，由于幽香并没有在道路上设置有效的排水措施，所以一些道路上充满了积水。理论上来说，这些积水显然拦不住前来赴宴的身强力壮的妖怪们，但是由于积水会导致淤泥的产生，所以爱干净的幽香不会走这些充满积水的道路。

具体来说，每条道路有一个排水能力 $p_i$ ，而当降水强度 $P$ 大于某条道路的排水能力时，这条边就会充满积水。

作为一场尤为盛大的生日宴会，只举办一天当然是不够的，所以幽香打算共举办 $T$ 天，在每一天都拿出最美味的 $k$ 个玉米招待好友（同样的，每个玉米田只能采摘一次），但是幽香很快发现了一个问题：如果宴会举办很多天的话，那么过几天后就没有玉米田可以采摘了，而且很多道路都会一直充满积水（也就是说积水不会在第二天自行消失）。因此她找来了精通魔法的帕秋莉，请她想想办法。

帕秋莉想了想，决定使用一种能使时空循环的禁忌魔法，也就是说每一天的宴会开始时玉米田和道路都会恢复到宴会前的状态。

当然，这种禁忌的魔法是有代价的：每一天都会有第一天宴会一样的大雨降下，而且每天宴会降雨的强度由于时空扭曲不一定相同。当然，为了举办这场宴会，这些小代价幽香自然可以接受。

为了防止客人们感到无聊，幽香在每一天都会选择一个玉米田 $c$ 举办宴会，然后从 $c$ 出发采摘美味度最大的 $k$ 个玉米（特别的是，如果能采摘的玉米个数不足 $k$ 个，那么她就会直接采摘所有能采摘的玉米）。

显然，由于玉米田数量繁多，幽香不可能每一天都跑遍所有能到达的玉米田并统计出美味度最大的 $k$ 个玉米，所以她找到了擅长编程的你来帮她解决这个问题。

具体来说，幽香会给你玉米田的结构，然后在 $T$ 天中每天告诉你降水强度 $P$ 和宴会举办地点 $c$ ，然后让你求出能采摘到的美味度最大的 $k$ 个玉米的美味度之和。为了减轻你的负担， $k$ 会是幽香在宴会开始前就决定的一个常数。

如果你成功地帮幽香解决了这个问题，你将会获得她赠送的礼物：一朵太阳花！

### 输入格式

从文件 `party.in` 中读入数据。

第一行两个整数 $n,m$,表示玉米田的个数和道路的条数

第二行 $n$ 个整数 $w_i$ ，表示每块玉米田中玉米的美味度

之后 $m$ 行，每行三个整数 $u_i,v_i,p_i$ ,表示一条连接第 $u_i$ 和第 $v_i$ 块玉米田，排水能力为 $p_i$的道路

之后一行两个整数 $T,k$ ,表示宴会举行的天数和每天要采摘玉米的个数

接下来 $T$ 行每行一个整数 $c_i,P_i$ ，表示每天的宴会举办地点和降水强度

### 输出格式

向文件 `party.out` 中输出答案。

共 $T$ 行，每行一个整数，表示每一天采摘的玉米美味度之和

### 样例1

> **输入**
> 
> ```plain
> 5 4
> 2 3 1 4 1
> 1 2 1
> 1 3 2
> 2 3 1
> 4 5 3
> 4 2
> 1 0
> 3 2
> 5 3
> 5 4
> ```
> 
> **输出**
> 
> ```plain
> 5
> 3
> 5
> 1
> ```
> 
> 见附加文件中的 `party1.in/out`

### 样例2

> 见附加文件中的 `party2.in/out`
> 
> 此样例与 `测试点4` 规模、性质相同

### 样例3

> 见附加文件中的 `party3.in/out`
> 
> 此样例与 `测试点6` 规模、性质相同

### 样例4

> 见附加文件中的 `party4.in/out`
> 
> 此样例与 `测试点9` 规模、性质相同

### 样例5

> 见附加文件中的 `party5.in/out`
> 
> 此样例与 `测试点16` 规模、性质相同

### 数据范围

所有测试点满足：

- $1 \leq n,m,T \leq 2*10^5$
- $1 \leq w_i \leq 100$
- $1 \leq u_i,v_i,c_i \leq n$
- $0 \leq p_i,P_i \leq 10^3$
- $1 \leq k \leq 10^4$

| Case | $n,m,T$              | $k$         | 特殊性质               |
|:----:|:--------------------:|:-----------:|:------------------:|
| $1$  | $\leq 10$            | $= 1$       | $P_i = 0$          |
| $2$  | $\leq 10$            | $= 1$       | -                  |
| $3$  | $\leq 10$            | $= 2$       | -                  |
| $4$  | $\leq 10$            | $\leq 10$   | -                  |
| $5$  | $\leq 10^3$          | $= 1$       | $P_i = 0$          |
| $6$  | $\leq 10^3$          | $= 1$       | $P_i \geq P_{i-1}$ |
| $7$  | $\leq 10^3$          | $= 1$       | $P_i \geq P_{i-1}$ |
| $8$  | $\leq 10^3$          | $= 1$       | -                  |
| $9$  | $\leq 10^3$          | $= 2$       | $P_i = 0$          |
| $10$ | $\leq 10^3$          | $= 2$       | $P_i \geq P_{i-1}$ |
| $11$ | $\leq 10^3$          | $= 2$       | $P_i \geq P_{i-1}$ |
| $12$ | $\leq 10^3$          | $= 2$       | -                  |
| $13$ | $\leq 10^3$          | $\leq 10^2$ | $P_i = 0$          |
| $14$ | $\leq 10^3$          | $\leq 10^2$ | $P_i \geq P_{i-1}$ |
| $15$ | $\leq 10^3$          | $\leq 10^2$ | $P_i \geq P_{i-1}$ |
| $16$ | $\leq 10^3$          | $\leq 10^2$ | -                  |
| $17$ | $\leq 2 \times 10^5$ | $= 1$       | $P_i \geq P_{i-1}$ |
| $18$ | $\leq 2 \times 10^5$ | $= 1$       | -                  |
| $19$ | $\leq 2 \times 10^5$ | $= 1$       | -                  |
| $20$ | $\leq 2 \times 10^5$ | $= 2$       | $P_i \geq P_{i-1}$ |
| $21$ | $\leq 2 \times 10^5$ | $= 2$       | -                  |
| $22$ | $\leq 2 \times 10^5$ | $= 2$       | -                  |
| $23$ | $\leq 2 \times 10^5$ | $\leq 10^4$ | $P_i = 0$          |
| $24$ | $\leq 2 \times 10^5$ | $\leq 10^4$ | $P_i \geq P_{i-1}$ |
| $25$ | $\leq 2 \times 10^5$ | $\leq 10^4$ | -                  |

---

# T3 玉米的丰收

英文名称：`WA.*`

时间限制：`1s`

空间限制：`256MB`

测试点数：`20`

### 题目描述

玉米高中的玉米地取得了大丰收，当务之急是在玉米地中找一个好位置把玉米集中起来（以供观赏）。

玉米高中的玉米地可以看作一个 $n$ 个点（这些点上种着玉米），$m$ 条边（玉米地中的小路）的无向图，每条边有边权（小路的长度），保证图联通。

搬运玉米是一件费时费力的事，所以集中玉米的位置应该使得这个位置到其它点的最远距离最小（两个点的距离为它们的最短路）。

注意这个位置可以在点上，也可以在某条边上。

### 输入格式

从文件 `WA.in` 中读入数据。

第`1`行包括两个整数 $n$，$m$。

接下来`m`行，每行输入一条边 $a_i$，$b_i$，$w_i$，其中 $a_i$，$b_i$ 是这条边连接的两个点，$w_i$ 是边权。

### 输出格式

向文件 `WA.out` 中输出答案。

输出一个实数，为最小的选择的位置到其他点的最远距离，答案正确当且仅当绝对误差不超过 $10^{-9}$。

### 样例1

> **输入**
> 
> ```plain
> 2 1
> 1 2 1
> ```
> 
> **输出**
> 
> ```plain
> 0.50
> ```
> 
> 见附加文件中的 `WA1.in/out`
> 
> **说明**
> 
> 容易发现最优位置在边的中点处，此时最远距离为`0.5`。

### 样例2

> **输入**
> 
> ```plain
> 3 3
> 1 2 1
> 2 3 1
> 1 3 1
> ```
> 
> **输出**
> 
> ```plain
> 1.00
> ```
> 
> 见附加文件中的 `WA2.in/out`
> 
> **说明**
> 
> 容易发现任意一个点都是最优位置处，此时最远距离为`1.0`。

### 样例3

> 见附加文件中的 `WA3.in/out`
> 
> 此样例与 `测试点10` 规模、性质相同

### 样例4

> 见附加文件中的 `WA4.in/out`
> 
> 此样例与 `测试点12` 规模、性质相同

### 数据范围

所有测试点满足：

- $2 \leq n \leq 300$
- $n-1 \leq m \leq \min \left( \frac {n \left( n-1 \right)}{2},2 \times 10^4 \right)$ 
- $1 \leq a_i,b_i \leq n$
- $a_i \neq b_i$
- $1 \leq w_i \leq 10^5$

| Case | $n$        | $m$                    | $w_i$                  |
|:----:|:----------:|:----------------------:|:----------------------:|
| $1$  | $= 2$      | $= 1$                  | $\leq 10$              |
| $2$  | $= 3$      | $=2$                   | $\leq 10$              |
| $3$  | $= 3$      | $=3$                   | $\leq 10$              |
| $4$  | $= 4$      | $=3$                   | $\leq 10$              |
| $5$  | $= 4$      | $=4$                   | $\leq 10$              |
| $6$  | $= 4$      | $=4$                   | $\leq 20$              |
| $7$  | $= 5$      | $=4$                   | $\leq 20$              |
| $8$  | $= 5$      | $=6$                   | $\leq 20$              |
| $9$  | $\leq 10$  | $= n - 1$              | $\leq 10 ^ 2$          |
| $10$ | $\leq 10$  | $\leq 20$              | $\leq 10 ^ 2$          |
| $11$ | $\leq 50$  | $= n - 1$              | $\leq 10 ^ 3$          |
| $12$ | $\leq 50$  | $\leq 10 ^ 2$          | $\leq 10 ^ 3$          |
| $13$ | $\leq 100$ | $= n - 1$              | $\leq 5 \times 10 ^ 3$ |
| $14$ | $\leq 100$ | $\leq 10 ^ 3$          | $\leq 5 \times 10 ^ 3$ |
| $15$ | $\leq 200$ | $= n - 1$              | $\leq 10 ^ 4$          |
| $16$ | $\leq 200$ | $\leq 2 \times 10 ^ 3$ | $\leq 10 ^ 4$          |
| $17$ | $\leq 200$ | $\leq 5 \times 10 ^ 3$ | $\leq 10 ^ 4$          |
| $18$ | $\leq 300$ | $= n - 1$              | $\leq 10 ^ 5$          |
| $19$ | $\leq 300$ | $\leq 10 ^ 4$          | $\leq 10 ^ 5$          |
| $20$ | $\leq 300$ | $\leq 2 \times 10 ^ 4$ | $\leq 10 ^ 5$          |
